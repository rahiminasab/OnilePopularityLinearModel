qt(1-0.5/2,n-p)
mse
anova(m)
mse <- 20532
sqrt(mse*(t(x_h)%*%solve(t(X)%*%X)%*%x_h))
t(x_h)%*%solve(t(X)%*%X)%*%x_h
solve(t(X)%*%X)
data <- data[,c(1,5,2,3,4)]
View(data)
install.packages("ppcor")
library(ppcor)
pcor(data[,-2])
data <- data[,-2]
View(data)
m_12 <- lm(Y~c(X1,X2),data)
m_12 <- lm(Y~X1,X2,data)
m_12 <- lm(Y~X1&X2,data)
m_12
m_12 <- lm(Y~X1+X2,data)
m_12
m
anova(m)
t(data$Y)%*%(H-(1/nrow(data))*J)%*%data$Y
data$bias <- rep(1,nrow(data))
data <- data[,c(1,5,2,3,4)]
H <- as.matrix(data[,-1])%*%solve(as.matrix(t(data[,-1]))%*%as.matrix(data[,-1]))%*%as.matrix(t(data[,-1]))
ssr <- t(data$Y)%*%(H-(1/nrow(data))*J)%*%data$Y
ssr
136366+5726+2034514
anov<-anova(m)
anov$`Sum Sq`
sum(anova(m)$`Sum Sq`[1:3])
sum(anova(m)$`Sum Sq`[1])
?anova
m_1 <- lm(Y~X1,data)
summary(m_1)$r.squared
anova(m_1)
u <- scale(data$Y)
u
u[1]
(data$Y[1]-mean(data$Y))/sd(data$Y)
u/sqrt(51)
1/c(sd(data$X1),sd(data$X2),sd(data$X3))
sd(data$Y)/c(sd(data$X1),sd(data$X2),sd(data$X3))
m$coefficients
m$coefficients$X1
(136366.2-130697.2)/((136366.2+130697.2)/2)
s1<-c(0,0.84,0.625,0.18,0.35,0)
s2<-c(0,0,0.683,0.45,0.18,0.025)
s3<-c(0.84,0.28,0.03,0.13,0.45,0.025)
s4<-c(1,1,1,1,1,1)
s5<-c(0.46,0.06,0.25,0,0,0.4)
s6<-c(0.46,0.2,0,0.13,0.05,0.3)
abs(s1-s2)
sum(abs(s1-s2))
sum(abs(s1-s2\3))
sum(abs(s1-s3))
sum(abs(s1-s4))
sum(abs(s1-s5))
sum(abs(s1-s6))
sum(abs(s3-s6))
sum(abs(s3-s5))
sum(abs(s3-s4))
sum(abs(s1-s3))
sum(abs(s1-s6))
sum(abs(s2-s6))
sum(abs(s2-s3))
sum(abs(s3-s4))
sum(abs(s3-s5))
sum(abs(s6-s5))
sum(abs(s6-s4))
sum(abs(s1-s4))
sum(abs(s1-s5))
sum(abs(s2-s5))
sum(abs(s2-s4))
pt<-c(0.5,0.25,0.1,0.1,0.2,0.1)
sum(abs(pt-s1))
sum(abs(pt-s2))
sum(abs(pt-s3))
sum(abs(pt-s4))
sum(abs(pt-s5))
sum(abs(pt-s6))
hw2 <- read.table("C:/Users/Ehsan/Downloads/hw2.csv", quote="\"", comment.char="")
View(hw2)
hist(hw2$V1)
boxplot(hw2$V1)
boxplot(hw2$V1, col = "blue")
boxplot(hw2$V1, col = "skyblue")
boxplot(hw2$V1, col = "skyblue", title="HG")
boxplot(hw2$V1, col = "skyblue", title="HG")
library(ggplot2)
ggplot(data = hw2$V1, aes(y=V1))+geom_boxplot()
ggplot(data = hw2, aes(y=V1))+geom_boxplot()
boxplot(hw2$V1, col = "skyblue")
boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution"))
boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution"))
ggplot(data = hw2, aes(y=V1))+geom_boxplot()
ggplot(data = hw2$V1, aes(y=V1))+geom_boxplot()
boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution"))
plot(boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution")))
plot(boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution")))
boxplot(hw2$V1, col = "skyblue", names= c("HW2 Grades Ditribution"))
abline(h=mean(hw2$V1))
abline(h=mean(hw2$V1), col="green")
abline(h=mean(hw2$V1), col="red")
library(tidyr)
library(dplyr)
library(leaps)
library(reshape2)
library(ggplot2)
library(Metrics)
library(boot)
library(car)
setwd("/Users/Ehsan/Desktop/DataProj/")
data <- read.csv("OnlineNewsPopularity.csv", stringsAsFactors = F)
data <- data %>%
filter(num_self_hrefs==0) %>%
filter(n_tokens_content != 0) %>%
arrange(timedelta) %>%
mutate(lshares=log(shares))
y <- data$shares
qqnorm(y)
qqline(y)
ly <- data$lshares
qqnorm(ly)
qqline(ly)
ly2 <- ly
ly2[ly2<=4] <- NA
ly2[ly2>=11] <- NA
qqnorm(ly2)
qqline(ly)
x_all <- data[,2:60]
x <- data[,c(2,3,5,10,11,13:19,39,45:46)]
x[,c(4,5)] <- sqrt(x[,c(4,5)])
dt <- cbind(x,ly)
names <- colnames(dt)
colnames(dt) <- c(paste("X",1:ncol(x), sep=""),"ly")
set.seed(123)
#--------------MODEL ASSUMPTIONS:
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
m1 <- lm(ly~X2+X3+X4+X5+X6+X7+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
outlierTest(m1)
tr[-c(2593,1758,1762),]
tr <- tr[-c(2593,1758,1762),]
set.seed(123)
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
tr2 <- tr[-c(2593,1758,1762),]
rg_exh2 <- regsubsets(ly~., tr2,nvmax = 15)
sm_exh2 <- summary(rg_exh)
coef(rg_exh2, which.max(sm_exh2$adjr2))
coef(rg_exh2, which.min(sm_exh2$bic))
m1_2 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr2)
m2_2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr2)
pr_m1_2 <- predict(m1_2,dv[,-ncol(dv)])
pr_m2_2 <- predict(m2_2,dv[,-ncol(dv)])
mspr1_2 <- rmse(pr_m1_2,dv[,ncol(dv)])^2
mspr2_2 <- rmse(pr_m2_2,dv[,ncol(dv)])^2
outlierTest(m1_2)
qqnorm(m1_2$residuals)
qqline(m1_2$residuals)
setwd("/Users/Ehsan/Desktop/DataProj/")
data <- read.csv("OnlineNewsPopularity.csv", stringsAsFactors = F)
set.seed(123)
data <- data %>%
filter(num_self_hrefs==0) %>%
filter(n_tokens_content != 0) %>%
arrange(timedelta) %>%
mutate(lshares=log(shares))
y <- data$shares
qqnorm(y)
qqline(y)
ly <- data$lshares
x <- data[,c(2,3,5,10,11,13:19,39,45:46)]
x[,c(4,5)] <- sqrt(x[,c(4,5)])
dt <- cbind(x,ly)
names <- colnames(dt)
colnames(dt) <- c(paste("X",1:ncol(x), sep=""),"ly")
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
coef(rg_exh, which.max(sm_exh$adjr2))
coef(rg_exh, which.min(sm_exh$bic))
m1 <- lm(ly~X2+X3+X4+X5+X6+X7+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
outlierTest(m1)
tr[2593,]
tr2 <- tr[-c(2593,1758,1762),]
tr2[2593,]
View(tr)
which(rownames(tr)==2593)
rem <- c(which(rownames(tr)==2593),which(rownames(tr)==1758),which(rownames(tr)==1762))
tr2 <- tr[-rem,]
rg_exh2 <- regsubsets(ly~., tr2,nvmax = 15)
sm_exh2 <- summary(rg_exh)
coef(rg_exh2, which.max(sm_exh2$adjr2))
coef(rg_exh, which.max(sm_exh$adjr2))
coef(rg_exh2, which.min(sm_exh2$bic))
set.seed(123)
#--------------MODEL ASSUMPTIONS:
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
coef(rg_exh, which.max(sm_exh$adjr2))
coef(rg_exh, which.min(sm_exh$bic))
m1 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
dt <- read.csv("processedSet.csv", stringsAsFactors = F)
cor(dt)
set.seed(123)
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
m1 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
dt <- cbind(x,ly)
names <- colnames(dt)
colnames(dt) <- c(paste("X",1:ncol(x), sep=""),"ly")
set.seed(123)
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
m1 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
write.csv(dt, "processedSet.csv", row.names = F)
dt <- read.csv("processedSet.csv", stringsAsFactors = F)
cor(dt)
set.seed(123)
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
m1 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
outlierTest(m1)
rem <- c(which(rownames(tr)==2593),which(rownames(tr)==1758),which(rownames(tr)==1762))
tr2 <- tr[-rem,]
rg_exh2 <- regsubsets(ly~., tr2,nvmax = 15)
sm_exh2 <- summary(rg_exh)
m1_2 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr2)
m2_2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr2)
pr_m1_2 <- predict(m1_2,dv[,-ncol(dv)])
pr_m2_2 <- predict(m2_2,dv[,-ncol(dv)])
mspr1_2 <- rmse(pr_m1_2,dv[,ncol(dv)])^2
mspr2_2 <- rmse(pr_m2_2,dv[,ncol(dv)])^2
qqnorm(m1_2$residuals)
qqline(m1_2$residuals)
outlierTest(m1_2)
pdf(file = "norm-ass.pdf")
qqnorm(m1_2$residuals)
qqline(m1_2$residuals)
dev.off()
pdf(file="var-ass.pdf")
plot(y=abs(m1_2$residuals), x=m1_2$fitted.values, xlab="Fitted Values", ylab = "Absolute residuals")
dev.off()
pdf(file="lin-rel.pdf")
plot(y=m1_2$residuals, x=m1_2$fitted.values, xlab="Fitted Values", ylab = "Residuals")
abline(h=0)
dev.off()
ncvTest(m1_2)
?ncvTest
vif(m1_2)
?vif
rsq <- function(formula, data, indices) {
d <- data[indices,] # allows boot to select sample
fit <- lm(formula, data=d)
return(summary(fit)$adj.r.squared)
}
results <- boot(data=tr, statistic=rsq,
R=1000, formula=ly~X2+X3+X5+X6+X8+X12+X13+X14)
results
plot(results)
boot.ci(results, type="norm")
bs <- function(formula, data, indices) {
d <- data[indices,] # allows boot to select sample
fit <- lm(formula, data=d)
return(coef(fit))
}
results <- boot(data=tr, statistic=bs,
R=1000, formula=ly~X2+X3+X5+X6+X8+X12+X13+X14)
boot.ci(results, type="norm", index=1) # intercept
adjr2 <- boot(data=tr, statistic=rsq,
R=1000, formula=ly~X2+X3+X5+X6+X8+X12+X13+X14)
coefs <- boot(data=tr, statistic=bs,
R=1000, formula=ly~X2+X3+X5+X6+X8+X12+X13+X14)
plot(adjr2)
boot.ci(results, type="norm")
boot.ci(adjr2, type="norm")
summary(m1_2)$adjr2
summary(m1_2)$adjr
summary(m1_2)
s <- summary(m1_2)
summary(m1_2)$adj.r.squared
mean(adjr2$t)
plot(results, index=1) # intercept
boot.ci(results, type="norm", index=1) # intercept
boot.ci(results, type="norm", index=2) # wt
boot.ci(results, type="norm", index=3) # wt
boot.ci(results, type="norm", index=4) # wt
boot.ci(results, type="norm", index=5) # wt
boot.ci(results, type="norm", index=6) # wt
boot.ci(results, type="norm", index=7) # wt
boot.ci(results, type="norm", index=8) # wt
boot.ci(results, type="norm", index=9) # wt
boot.ci(results, type="norm", index=10) # wt
bt_coefs <- apply(coefs,2,mean)
bt_coefs <- apply(coefs$t,2,mean)
bt_coefs
ts[1,"X2"]
bt_pr <- c()
for(i in 1:nrow(ts)){
pr <- bt_coefs[1]+ts[i,"X2"]*bt_coefs[2]+ts[i,"X3"]*bt_coefs[3]+ts[i,"X5"]*bt_coefs[4]+ts[i,"X6"]*bt_coefs[5]+
ts[i,"X8"]*bt_coefs[6]+ts[i,"X12"]*bt_coefs[7]+ts[i,"X13"]*bt_coefs[8]+ts[i,"X14"]*bt_coefs[9]
bt_pr <- c(bt_pr,pr)
}
mspr_bt <- rmse(bt_pr,ts[,ncol(ts)])^2
pr_m1_2_ts <- predict(m1_2,ts[,-ncol(ts)])
mspr_m_1_2_ts <- rmse(pr_m1_2_ts,ts[,ncol(ts)])^2
m1_2$coefficients
View(dt)
View(data)
View(tr)
View(data)
names
length(names)
names
data <- data %>%
filter(num_self_hrefs==0) %>%
filter(n_tokens_content != 0) %>%
arrange(timedelta) %>%
mutate(lshares=log(shares))
data <- data[,c(2,3,5,10,11,13:19,39,45:46, ncol(data))]
colnames(data) <- c(paste("X",1:(ncol(data)-1), sep=""),"y")
View(data)
boxcox(y~.,data)
library(MASS)
boxcox(y~.,data)
boxcox(y~.,data=data)
library(tidyr)
library(dplyr)
library(leaps)
library(reshape2)
library(ggplot2)
library(Metrics)
library(boot)
library(car)
library(MASS)
setwd("/Users/Ehsan/Desktop/DataProj/")
data <- read.csv("OnlineNewsPopularity.csv", stringsAsFactors = F)
set.seed(123)
data <- data %>%
filter(num_self_hrefs==0) %>%
filter(n_tokens_content != 0) %>%
arrange(timedelta) %>%
mutate(lshares=log(shares))
data <- data[,c(2,3,5,10,11,13:19,39,45:46, ncol(data)-1)]
colnames(data) <- c(paste("X",1:(ncol(data)-1), sep=""),"y")
boxcox(y~.,data=data)
qqnorm(y)
qqline(y)
qqnorm(data$y)
qqline(data$y)
data_all <- read.csv("OnlineNewsPopularity.csv", stringsAsFactors = F)
set.seed(123)
data_filtered <- data_all %>%
filter(num_self_hrefs==0) %>%
filter(n_tokens_content != 0) %>%
arrange(timedelta) %>%
mutate(lshares=log(shares))
data_selected <- data[,c(2,3,5,10,11,13:19,39,45:46, ncol(data)-1)]
data_selected <- data_filtered[,c(2,3,5,10,11,13:19,39,45:46, ncol(data)-1)]
colnames(data_selected) <- c(paste("X",1:(ncol(data_selected)-1), sep=""),"y")
boxcox(y~.,data=data_selected)
data_selected <- data_filtered[,c(2,3,5,10,11,13:19,39,45:46, ncol(data_filtered)-1)]
colnames(data_selected) <- c(paste("X",1:(ncol(data_selected)-1), sep=""),"y")
boxcox(y~.,data=data_selected)
qqnorm(data_selected$y)
qqline(data_selected$y)
ly <- data_all$lshares
qqnorm(ly)
ly <- data_all$lshares
ly <- data_filtered$lshares
qqnorm(ly)
qqline(ly)
x <- data_selected[,-y]
x <- data_selected[,-"y"]
x <- data_selected[,-ncol(data_selected)]
boxplot(sqrt(x[,4]))
boxplot(sqrt(x[,4]))
boxplot(x[,4])
boxplot(sqrt(x[,4]))
hist(x[,4])
hist(sqrt(x[,5]))
hist(log(sqrt(x[,4])))
hist(log(log(log(y)^2)^2))
x[,c(4,5)] <- sqrt(x[,c(4,5)])
d <- melt(cbind(x,y))
ggplot(d,aes(x = value)) +
facet_wrap(~variable,scales = "free") +
geom_histogram()
y <- data_filtered$shares
d <- melt(cbind(x,y))
ggplot(d,aes(x = value)) +
facet_wrap(~variable,scales = "free") +
geom_histogram()
d <- melt(cbind(x,ly))
ggplot(d,aes(x = value)) +
facet_wrap(~variable,scales = "free") +
geom_histogram()
dt <- cbind(x,ly)
names <- colnames(dt)
colnames(dt) <- c(paste("X",1:ncol(x), sep=""),"ly")
cor(dt)
tr <- sample_frac(dt, 0.7)
tmp <- anti_join(dt,tr)
dv <- sample_frac(tmp, 0.4)
ts <- anti_join(tmp,dv)
rg_exh <- regsubsets(ly~., tr,nvmax = 15)
sm_exh <- summary(rg_exh)
par(mfrow=c(2,2))
plot(sm_exh$rss, xlab="Number of variables", ylab="RSS", type="l")
plot(sm_exh$adjr2, xlab="Number of variables", ylab="adjR2", type="l")
plot(sm_exh$cp, xlab="Number of variables", ylab="Cp", type="l")
plot(sm_exh$bic, xlab="Number of variables", ylab="bic", type="l")
coef(rg_exh, which.max(sm_exh$adjr2))
coef(rg_exh, which.min(sm_exh$bic))
m1 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr)
m2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr)
pr_m1 <- predict(m1,dv[,-ncol(dv)])
pr_m2 <- predict(m2,dv[,-ncol(dv)])
mspr1 <- rmse(pr_m1,dv[,ncol(dv)])^2
mspr2 <- rmse(pr_m2,dv[,ncol(dv)])^2
outlierTest(m1)
qqPlot(m1, main="QQ Plot")
rem <- c(which(rownames(tr)==2593),which(rownames(tr)==1758),which(rownames(tr)==1762))
tr2 <- tr[-rem,]
rg_exh2 <- regsubsets(ly~., tr2,nvmax = 15)
sm_exh2 <- summary(rg_exh)
coef(rg_exh2, which.max(sm_exh2$adjr2))
coef(rg_exh2, which.min(sm_exh2$bic))
m1_2 <- lm(ly~X2+X3+X5+X6+X8+X12+X13+X14,tr2)
m2_2 <- lm(ly~X2+X5+X8+X12+X13+X14,tr2)
pr_m1_2 <- predict(m1_2,dv[,-ncol(dv)])
pr_m2_2 <- predict(m2_2,dv[,-ncol(dv)])
mspr1_2 <- rmse(pr_m1_2,dv[,ncol(dv)])^2
mspr2_2 <- rmse(pr_m2_2,dv[,ncol(dv)])^2
qqnorm(m1_2$residuals)
qqline(m1_2$residuals)
outlierTest(m1_2)
pdf(file = "norm-ass.pdf")
qqnorm(m1_2$residuals)
qqline(m1_2$residuals)
dev.off()
plot(y=abs(m1_2$residuals), x=m1_2$fitted.values, xlab="Fitted Values", ylab = "Absolute residuals")
ncvTest(m1_2)
plot(y=m1_2$residuals, x=m1_2$fitted.values, xlab="Fitted Values", ylab = "Residuals")
abline(h=0)
rsq <- function(formula, data, indices) {
d <- data[indices,] # allows boot to select sample
fit <- lm(formula, data=d)
return(summary(fit)$adj.r.squared)
}
adjr2 <- boot(data=tr, statistic=rsq,
R=1000, formula=ly~X2+X3+X5+X6+X8+X12+X13+X14)
plot(adjr2)
boot.ci(adjr2, type="norm")
